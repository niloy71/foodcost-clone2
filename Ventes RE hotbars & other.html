<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>foodcosts â€“ ventes-re-hotbars--other</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">foodcosts</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ventes RE hotbars &amp; other.html">Ventes RE hotbars &amp; other.html</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">foodcosts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">core</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Average foodcost per revenue for shops and RE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Average foodcost per revenue for shops and RE.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./can we spot the best salesperson?.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Add more features</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Corporate restaurants unit economics including wages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Corporate restaurants unit economics including wages.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day dashboard.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Shop LATEM</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./re wpp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">WPP products solds last n days</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./salad bar &amp; hotbar sales in latem &amp; overijse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">what is selling the best salad bar or hotbar in Latem?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Shop unit economics including wages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Shop unit economics including wages.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ventes RE hotbars &amp; other.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Ventes RE hotbars &amp; other.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Vraag guy ivm winkels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vraag guy ivm winkels.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./automatic-daily-report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">automatic-daily-report.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./best_selling_products.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">best_selling_products.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./events_made_in_shop_and_re.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">events_made_in_shop_and_re.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./food_costs_simplified_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">the parameters to set</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fruit_basket.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">fruit_basket.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nbr_days_unsold_products_in_latem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">nbr_days_unsold_products_in_latem.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pavlova_bar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">pavlova_bar.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sales pavlova bar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">WPP products solds last n days</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sales_initiatives_latem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chocolate mousses</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./shop_unit_economics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">shop_unit_economics.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./should we open the corporate restaurants on the friday after a public holiday?.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Should we open the corporate restaurant the Friday after a public holiday?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stock outs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">stock outs.html</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> foodcosts.core <span class="im">as</span> core</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.multipart <span class="im">import</span> MIMEMultipart</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_hotbar_sales():</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    pd <span class="op">=</span> core.get_query_res_as_pd(<span class="st">"select * from v_resto_entreprise;"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pd)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>make_hotbar_sales()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>config.ini file available... using that
    id                  name
0   14    R.E. ALLEN &amp; OVERY
1   15   R.E. LHOIST CORBAIS
2   21         R.E. ZAVENTEM
3   22            R.E. CEFIC
4   24             R.E ALOST
5   34   R.E LHOIST NIVELLES
6   35  R.E LHOIST LIMELETTE
7   37         BOTANIC TOWER
8   38             R.E ENGIE
9   42          R.E THE HIVE
10  43       R.E EUROCONTROL
11  45        R.E LIGHTHOUSE
12  65         Immogra Park7
13  68         R.E. JanDeNul
14  69                ARAMIS
15  70        R.E. GLAVERBEL
16  71               R.E WPP</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>14</td>
<td>R.E. ALLEN &amp; OVERY</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>15</td>
<td>R.E. LHOIST CORBAIS</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>21</td>
<td>R.E. ZAVENTEM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>22</td>
<td>R.E. CEFIC</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>24</td>
<td>R.E ALOST</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>34</td>
<td>R.E LHOIST NIVELLES</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>35</td>
<td>R.E LHOIST LIMELETTE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>37</td>
<td>BOTANIC TOWER</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>38</td>
<td>R.E ENGIE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>42</td>
<td>R.E THE HIVE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>43</td>
<td>R.E EUROCONTROL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>45</td>
<td>R.E LIGHTHOUSE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>65</td>
<td>Immogra Park7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>68</td>
<td>R.E. JanDeNul</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>69</td>
<td>ARAMIS</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>70</td>
<td>R.E. GLAVERBEL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>71</td>
<td>R.E WPP</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sales_re <span class="op">=</span> core.get_products_sold_for_a_re_as_pd(core.get_previous_n_day(<span class="dv">10</span>),core.get_today_date_string(), <span class="st">'R.E. GLAVERBEL'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>config.ini file available... using that</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sales_re.sort_values(<span class="st">'units_sold'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">shop_name</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">product_name</th>
<th data-quarto-table-cell-role="th">units_sold</th>
<th data-quarto-table-cell-role="th">total_sales</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>R.E. GLAVERBEL</td>
<td>2023-03-20</td>
<td>PLAT DU JOUR 10.9</td>
<td>84.000</td>
<td>915.60000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">103</td>
<td>R.E. GLAVERBEL</td>
<td>2023-03-22</td>
<td>SANDWICH BASE</td>
<td>80.000</td>
<td>286.40000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">112</td>
<td>R.E. GLAVERBEL</td>
<td>2023-03-22</td>
<td>POTAGE DU JOUR PETIT</td>
<td>79.000</td>
<td>237.00000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">156</td>
<td>R.E. GLAVERBEL</td>
<td>2023-03-23</td>
<td>POTAGE DU JOUR PETIT</td>
<td>78.000</td>
<td>234.00000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>R.E. GLAVERBEL</td>
<td>2023-03-20</td>
<td>POTAGE DU JOUR PETIT</td>
<td>78.000</td>
<td>234.00000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">204</td>
<td>R.E. GLAVERBEL</td>
<td>2023-03-24</td>
<td>MENDIANTS HOMEMADE (Chocolat noir)</td>
<td>0.080</td>
<td>2.87600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">73</td>
<td>R.E. GLAVERBEL</td>
<td>2023-03-21</td>
<td>MENDIANTS HOMEMADE (Chocolat blanc)</td>
<td>0.078</td>
<td>2.80410</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">119</td>
<td>R.E. GLAVERBEL</td>
<td>2023-03-22</td>
<td>MENDIANTS HOMEMADE (Chocolat noir)</td>
<td>0.070</td>
<td>2.51650</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">246</td>
<td>R.E. GLAVERBEL</td>
<td>2023-03-27</td>
<td>MENDIANTS HOMEMADE (Chocolat au lait)</td>
<td>0.059</td>
<td>2.12105</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">247</td>
<td>R.E. GLAVERBEL</td>
<td>2023-03-27</td>
<td>MENDIANTS HOMEMADE (Chocolat noir)</td>
<td>0.044</td>
<td>1.58180</td>
</tr>
</tbody>
</table>

<p>263 rows Ã— 5 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_products_order_for_a_re_as_pd(start_date, end_date, shop_name):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Construct the SQL query</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    query <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="ss">        SELECT v_resto_entreprise.name AS shop_name, </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="ss">               DATE(v_pos_order.created_at) AS day, </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="ss">               v_product.name AS product_name, </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="ss">                v_pos_order_line.product_id as product_id,</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="ss">                count(v_pos_order_line.product_id) as total_order,</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="ss">               SUM(v_pos_order_line.quantity) AS units_sold, </span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="ss">               SUM(v_pos_order_line.quantity * v_product.price) AS total_sales</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="ss">        FROM v_pos_order_line</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="ss">        LEFT JOIN v_product ON v_product.id = v_pos_order_line.product_id</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="ss">        LEFT JOIN v_pos_order ON v_pos_order.id = v_pos_order_line.order_id</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="ss">        LEFT JOIN v_pos_session ON v_pos_session.id = v_pos_order.session_id</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="ss">        LEFT JOIN v_pos ON v_pos.id = v_pos_session.pos_id</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="ss">        LEFT JOIN v_resto_entreprise ON v_resto_entreprise.id = v_pos.shop_id</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="ss">        WHERE v_pos_order.created_at BETWEEN '</span><span class="sc">{</span>start_date<span class="sc">}</span><span class="ss">' AND '</span><span class="sc">{</span>end_date<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="ss">        AND v_resto_entreprise.name IN ('</span><span class="sc">{</span>shop_name<span class="sc">}</span><span class="ss">')</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="ss">        AND (v_product.name LIKE '%PLAT DU JOUR%' OR</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="ss">            v_product.name LIKE '%HOT BAR FTK%')</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="ss">        GROUP BY v_resto_entreprise.id, v_resto_entreprise.name, day, v_product.id, v_product.name, v_pos_order_line.product_id</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="ss">        ORDER BY v_resto_entreprise.name, day ASC;</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> core.get_query_res_as_pd(query)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>re_restaurants <span class="op">=</span> core.get_query_res_as_pd(<span class="st">"select * from v_resto_entreprise;"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>re_restaurants_sales_details <span class="op">=</span> {</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    re_restaurant_name: get_products_order_for_a_re_as_pd(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        core.get_previous_n_day(<span class="dv">60</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        core.get_today_date_string(),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        re_restaurant_name</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> re_restaurant_name <span class="kw">in</span> re_restaurants[<span class="st">'name'</span>]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that
config.ini file available... using that</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_total_order(sales_details, product_name):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    unit_sold <span class="op">=</span> sales_details[sales_details[<span class="st">'product_name'</span>].<span class="bu">str</span>.contains(product_name, regex<span class="op">=</span><span class="va">False</span>)][<span class="st">'total_order'</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> unit_sold.values.<span class="bu">sum</span>()<span class="op">;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_percetage(x, y):</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:       </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        x_percentage <span class="op">=</span> <span class="bu">round</span>((x<span class="op">*</span><span class="dv">100</span><span class="op">/</span>(x<span class="op">+</span>y)),<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        y_percentage <span class="op">=</span> <span class="bu">round</span>((y<span class="op">*</span><span class="dv">100</span><span class="op">/</span>(x<span class="op">+</span>y)),<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x_percentage, y_percentage<span class="op">;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ZeroDivisionError</span>:</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">float</span>(<span class="st">'NaN'</span>), <span class="bu">float</span>(<span class="st">'NaN'</span>)<span class="op">;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getAxisPosition(sales):</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    index <span class="op">=</span> sales.index.values[<span class="dv">0</span>]</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> index <span class="op">//</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> index <span class="op">%</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x, y<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>order_dict <span class="op">=</span> {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Name'</span>:[],</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'PLAT DU JOUR'</span>:[],</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'HOT BAR'</span>:[],</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>order_percentage_dict <span class="op">=</span> {</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Name'</span>:[],</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'PLAT DU JOUR(%)'</span>:[],</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'HOT BAR(%)'</span>:[],</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>order_dataframe <span class="op">=</span> pd.DataFrame(order_dict)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>order_percentage_dataframe <span class="op">=</span> pd.DataFrame(order_percentage_dict)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>order_dataframe.style.set_caption(<span class="st">"Hello World"</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>order_dataframe[<span class="st">'PLAT DU JOUR'</span>] <span class="op">=</span> order_dataframe[<span class="st">'PLAT DU JOUR'</span>].astype(<span class="st">'int'</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>order_dataframe[<span class="st">'HOT BAR'</span>] <span class="op">=</span> order_dataframe[<span class="st">'HOT BAR'</span>].astype(<span class="st">'int'</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> re_restaurant_name <span class="kw">in</span> re_restaurants[<span class="st">'name'</span>]:</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    sales_details <span class="op">=</span> re_restaurants_sales_details[re_restaurant_name]<span class="op">;</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    plat_du_jour_total_order <span class="op">=</span> get_total_order(sales_details, <span class="st">'PLAT DU JOUR'</span>)<span class="op">;</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    hot_bar_total_order <span class="op">=</span> get_total_order(sales_details, <span class="st">'HOT BAR'</span>)<span class="op">;</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    plat_du_jour_percentage, hot_bar_percentage <span class="op">=</span> get_percetage(plat_du_jour_total_order, hot_bar_total_order)<span class="op">;</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    order_dataframe.loc[<span class="bu">len</span>(order_dataframe.index)] <span class="op">=</span> [</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        re_restaurant_name,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>        plat_du_jour_total_order,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        hot_bar_total_order,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    order_percentage_dataframe.loc[<span class="bu">len</span>(order_percentage_dataframe.index)] <span class="op">=</span> [</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>        re_restaurant_name,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        plat_du_jour_percentage,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>        hot_bar_percentage,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>display(order_dataframe)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>display(order_percentage_dataframe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">PLAT DU JOUR</th>
<th data-quarto-table-cell-role="th">HOT BAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>R.E. ALLEN &amp; OVERY</td>
<td>740</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>R.E. LHOIST CORBAIS</td>
<td>1246</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>R.E. ZAVENTEM</td>
<td>2677</td>
<td>2154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>R.E. CEFIC</td>
<td>937</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>R.E ALOST</td>
<td>453</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>R.E LHOIST NIVELLES</td>
<td>512</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>R.E LHOIST LIMELETTE</td>
<td>915</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>BOTANIC TOWER</td>
<td>1349</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>R.E ENGIE</td>
<td>5640</td>
<td>2788</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>R.E THE HIVE</td>
<td>1268</td>
<td>1477</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>R.E EUROCONTROL</td>
<td>76</td>
<td>2802</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>R.E LIGHTHOUSE</td>
<td>0</td>
<td>955</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Immogra Park7</td>
<td>1</td>
<td>104</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>R.E. JanDeNul</td>
<td>0</td>
<td>43</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>ARAMIS</td>
<td>0</td>
<td>1430</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>R.E. GLAVERBEL</td>
<td>2385</td>
<td>2685</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>R.E WPP</td>
<td>124</td>
<td>128</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">PLAT DU JOUR(%)</th>
<th data-quarto-table-cell-role="th">HOT BAR(%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>R.E. ALLEN &amp; OVERY</td>
<td>100.00</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>R.E. LHOIST CORBAIS</td>
<td>100.00</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>R.E. ZAVENTEM</td>
<td>55.41</td>
<td>44.59</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>R.E. CEFIC</td>
<td>100.00</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>R.E ALOST</td>
<td>100.00</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>R.E LHOIST NIVELLES</td>
<td>100.00</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>R.E LHOIST LIMELETTE</td>
<td>100.00</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>BOTANIC TOWER</td>
<td>100.00</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>R.E ENGIE</td>
<td>66.92</td>
<td>33.08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>R.E THE HIVE</td>
<td>46.19</td>
<td>53.81</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>R.E EUROCONTROL</td>
<td>2.64</td>
<td>97.36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>R.E LIGHTHOUSE</td>
<td>0.00</td>
<td>100.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Immogra Park7</td>
<td>0.95</td>
<td>99.05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>R.E. JanDeNul</td>
<td>0.00</td>
<td>100.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>ARAMIS</td>
<td>0.00</td>
<td>100.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>R.E. GLAVERBEL</td>
<td>47.04</td>
<td>52.96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>R.E WPP</td>
<td>49.21</td>
<td>50.79</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">6</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="fl">0.03</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> re_restaurant_name <span class="kw">in</span> re_restaurants[<span class="st">'name'</span>]:</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    sales <span class="op">=</span> order_dataframe[order_dataframe[<span class="st">'Name'</span>] <span class="op">==</span> re_restaurant_name]<span class="op">;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> getAxisPosition(sales)<span class="op">;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ax[x, y].bar(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'PLAT DU JOUR'</span>, <span class="st">'HOT BAR'</span>],</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        [sales[<span class="st">'PLAT DU JOUR'</span>].item(), sales[<span class="st">'HOT BAR'</span>].item()], label<span class="op">=</span><span class="st">'units'</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    ax[x, y].legend()</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    ax[x, y].set_title(<span class="ss">f'</span><span class="sc">{</span>re_restaurant_name<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>ax.flat[<span class="op">-</span><span class="dv">1</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Total Order'</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Ventes RE hotbars &amp; other_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">6</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">16</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="fl">0.03</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> re_restaurant_name <span class="kw">in</span> re_restaurants[<span class="st">'name'</span>]:</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    sales <span class="op">=</span> order_percentage_dataframe[order_percentage_dataframe[<span class="st">'Name'</span>] <span class="op">==</span> re_restaurant_name]<span class="op">;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> getAxisPosition(sales)<span class="op">;</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    plat_du_jour_sales_percentage <span class="op">=</span> sales[<span class="st">'PLAT DU JOUR(%)'</span>].item()</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    hot_bar_sales_percentage <span class="op">=</span> sales[<span class="st">'HOT BAR(%)'</span>].item()</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(math.isnan(plat_du_jour_sales_percentage) <span class="kw">or</span> math.isnan(hot_bar_sales_percentage)):</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'Data is invalid to genarate pie chart for resturent: </span><span class="sc">{</span>re_restaurant_name<span class="sc">}</span><span class="ss">'</span>)<span class="op">;</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>        ax[x, y].set_title(<span class="ss">f'</span><span class="sc">{</span>re_restaurant_name<span class="sc">}</span><span class="ss">'</span>)<span class="op">;</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    ax[x, y].pie(</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        [plat_du_jour_sales_percentage, hot_bar_sales_percentage],</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    ax[x, y].legend(labels <span class="op">=</span> [<span class="st">'PLAT DU JOUR'</span>, <span class="st">'HOT BAR'</span>])</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    ax[x, y].set_title(<span class="ss">f'</span><span class="sc">{</span>re_restaurant_name<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>ax.flat[<span class="op">-</span><span class="dv">1</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Percentage of Unit Sold'</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Ventes RE hotbars &amp; other_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#8 Create a clearer view on eurocontrol sales</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_products_sales_for_a_re_as_pd(start_date, end_date, shop_name):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    query <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="ss">        SELECT  </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="ss">               v_product.name AS product_name, </span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="ss">               SUM(v_pos_order_line.quantity * v_product.price) AS total_sales</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="ss">        FROM v_pos_order_line</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="ss">        LEFT JOIN v_product ON v_product.id = v_pos_order_line.product_id</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="ss">        LEFT JOIN v_pos_order ON v_pos_order.id = v_pos_order_line.order_id</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="ss">        LEFT JOIN v_pos_session ON v_pos_session.id = v_pos_order.session_id</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="ss">        LEFT JOIN v_pos ON v_pos.id = v_pos_session.pos_id</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="ss">        LEFT JOIN v_resto_entreprise ON v_resto_entreprise.id = v_pos.shop_id</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="ss">        WHERE v_pos_order.created_at BETWEEN '2023-01-24' AND '2023-03-25'</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="ss">        AND v_resto_entreprise.name IN ('R.E EUROCONTROL')</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="ss">        GROUP BY v_product.id, v_product.name</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="ss">        ORDER BY total_sales DESC;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> core.get_query_res_as_pd(query)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>products_sales <span class="op">=</span> get_products_sales_for_a_re_as_pd(</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        core.get_previous_n_day(<span class="dv">60</span>),</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        core.get_today_date_string(),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R.E EUROCONTROL"</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>config.ini file available... using that</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>total_sales <span class="op">=</span> products_sales[<span class="st">'total_sales'</span>].<span class="bu">sum</span>()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>products_sales[<span class="st">'total_sales'</span>] <span class="op">=</span> <span class="bu">round</span>(products_sales[<span class="st">'total_sales'</span>], <span class="dv">2</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>products_sales[<span class="st">'sales_percentage'</span>] <span class="op">=</span> <span class="bu">round</span>(products_sales[<span class="st">'total_sales'</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">/</span> total_sales, <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="va">None</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>display(products_sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">product_name</th>
<th data-quarto-table-cell-role="th">total_sales</th>
<th data-quarto-table-cell-role="th">sales_percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>HOT MEAL OF THE DAY</td>
<td>34293.42</td>
<td>24.57</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>CHEF'S CHOICE</td>
<td>31127.62</td>
<td>22.30</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>SALADE BAR FTK</td>
<td>27958.87</td>
<td>20.03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>HOT BAR FTK</td>
<td>26329.98</td>
<td>18.87</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>POTAGE DU JOUR PETIT</td>
<td>7281.00</td>
<td>5.22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>QUARTIER DE TARTE</td>
<td>1265.85</td>
<td>0.91</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>PLAT DU JOUR VEGE RE</td>
<td>1100.00</td>
<td>0.79</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>TRANCHE DE PAIN</td>
<td>1063.00</td>
<td>0.76</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>COCA ZERO 50CL PET</td>
<td>915.00</td>
<td>0.66</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>SALADE DE FRUITS DE SAISON</td>
<td>812.20</td>
<td>0.58</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>PAVLOVA ON THE GO</td>
<td>776.00</td>
<td>0.56</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>BRU PETILLANTE PLASTIQUE 50 CL</td>
<td>720.00</td>
<td>0.52</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>SPA REINE BLEU PET 50CL</td>
<td>634.40</td>
<td>0.45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>COCA COLA REGULAR 50CL</td>
<td>541.50</td>
<td>0.39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>MOUSSE CHOCOLAT 110G</td>
<td>508.40</td>
<td>0.36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>COOKIE 1PCE</td>
<td>399.30</td>
<td>0.29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>TIRAMISU CLASSIQUE 110G</td>
<td>337.90</td>
<td>0.24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>TIRAMISU SPECULOOS 110G</td>
<td>254.20</td>
<td>0.18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>NATURAL LIMONADE FTK (Citron)</td>
<td>195.00</td>
<td>0.14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>ICE TEA 50 CL</td>
<td>180.20</td>
<td>0.13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>PAIN + BEURRE</td>
<td>178.50</td>
<td>0.13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>JUS DE FRUITS FRAIS 250 ML (Fraise Citron)</td>
<td>163.20</td>
<td>0.12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>FRUIT 1PCE</td>
<td>156.80</td>
<td>0.11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>RIZ AU LAIT / FRAISES / RHUBARBE</td>
<td>145.70</td>
<td>0.10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>GRAND SUD MERLOT ROSE 25CL</td>
<td>139.26</td>
<td>0.10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>HOMEMADE CAKE CITRON 1 PCE</td>
<td>136.50</td>
<td>0.10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>SPRITE 50 CL</td>
<td>132.00</td>
<td>0.09</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>FANTA ORANGE 50 CL</td>
<td>126.00</td>
<td>0.09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>RIZ AU LAIT 150G</td>
<td>125.40</td>
<td>0.09</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>JUS DE FRUITS FRAIS 250 ML (Banane Citron)</td>
<td>121.60</td>
<td>0.09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>NATURAL LIMONADE FTK (PÃªche)</td>
<td>104.00</td>
<td>0.07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>JUS DE FRUITS FRAIS 250 ML (Orange)</td>
<td>102.40</td>
<td>0.07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>TARTE MOELLEUX CHOCOLAT PORTION</td>
<td>101.85</td>
<td>0.07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>RIZ AU LAIT / FRAMBOISES 110G</td>
<td>93.00</td>
<td>0.07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>MENDIANTS HOMEMADE (Chocolat noir)</td>
<td>75.28</td>
<td>0.05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>GRAND SUD SAUVIGNON BLANC 25CL</td>
<td>71.74</td>
<td>0.05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>PANNA COTTA (Coulis de fruits rouges)</td>
<td>71.30</td>
<td>0.05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>MENDIANTS HOMEMADE (Chocolat au lait)</td>
<td>68.31</td>
<td>0.05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>NATURAL LIMONADE FTK (Hibiscus)</td>
<td>68.25</td>
<td>0.05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>BRUSSELS BEER PROJECT 25CL (Delta)</td>
<td>49.00</td>
<td>0.04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>BRUSSELS BEER PROJECT 25CL (Grosse Bertha)</td>
<td>49.00</td>
<td>0.04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>PUDDING DE CHIA / MYRTILLES (Lait de coco et g...</td>
<td>45.60</td>
<td>0.03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>CHIPS LEGUMES 100G</td>
<td>43.65</td>
<td>0.03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>TIRAMISU MANGUE / CITRON VERT 110G</td>
<td>43.40</td>
<td>0.03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>HOMEMADE CAKE CAROTTE 1 PCE</td>
<td>42.90</td>
<td>0.03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>MENDIANTS HOMEMADE (Chocolat blanc)</td>
<td>27.14</td>
<td>0.02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">46</td>
<td>MACARONS 12PCS</td>
<td>27.00</td>
<td>0.02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">47</td>
<td>HOMEMADE CAKE (Carotte)</td>
<td>25.59</td>
<td>0.02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48</td>
<td>GRAND SUD MERLOT IGP RED 25CL</td>
<td>21.10</td>
<td>0.02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">49</td>
<td>BONBON BATON ACIDULE BOUTEILLE 340G</td>
<td>20.70</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50</td>
<td>BONBON SUCRE COEUR 100G</td>
<td>20.10</td>
<td>0.01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">51</td>
<td>GUINNESS NA 44ML</td>
<td>19.75</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">52</td>
<td>WASABI NUTS GRAND POT</td>
<td>19.50</td>
<td>0.01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">53</td>
<td>MONT BLANC ON THE GO</td>
<td>19.40</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">54</td>
<td>SACHET DE CUBERDON</td>
<td>18.00</td>
<td>0.01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">55</td>
<td>CACAHUETE MIEL CRANBERRY 200G</td>
<td>17.40</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56</td>
<td>4 LAITS - 4 NOIRS MINIS MELOCAKES ARTISANAL</td>
<td>17.00</td>
<td>0.01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">57</td>
<td>TARTE AU RIZ PORTION</td>
<td>14.55</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>BONBON CITROS BOUTEILLE 340G</td>
<td>13.80</td>
<td>0.01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">59</td>
<td>BONBON OURS ACIDULE BOUTEILLE 370G</td>
<td>13.80</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">60</td>
<td>CAVA MVSA 20CL (20 cl)</td>
<td>10.20</td>
<td>0.01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">61</td>
<td>1 - 1P FILET Dâ€™AIGLEFIN, SAUCE AUX POIVRONS DO...</td>
<td>9.89</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">62</td>
<td>1 - 12P FILET DE DAURADE EN CROÃ›TE Dâ€™Ã‰PICES, S...</td>
<td>9.89</td>
<td>0.01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">63</td>
<td>1 - 2P CHOU FARCI, JEUNES CAROTTES AU CÃ‰LERI E...</td>
<td>9.89</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">64</td>
<td>4 BLANCS - 4 LAITS MINIS MELOCAKES ARTISANAL</td>
<td>8.50</td>
<td>0.01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">65</td>
<td>8 NOIRS MINIS MELOCAKES ARTISANAL</td>
<td>8.50</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">66</td>
<td>CRUNCHY ALMONDS 60G</td>
<td>8.30</td>
<td>0.01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">67</td>
<td>SACHET MINI CUBERDON 200G</td>
<td>8.30</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">68</td>
<td>BONBON SOURIS NOIRES BOUTEILLE 430G</td>
<td>6.90</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">69</td>
<td>BONBON ANIS 420G</td>
<td>6.90</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">70</td>
<td>WASABI NUTS PETIT POT</td>
<td>5.70</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">71</td>
<td>HOMEMADE CAKE (Citron)</td>
<td>5.21</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">72</td>
<td>SALADE FRUIT SAISON</td>
<td>4.98</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">73</td>
<td>TARTE FROMAGE SPECULOOS PORTION</td>
<td>4.85</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">74</td>
<td>WASABI PEAS 90G</td>
<td>2.85</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>HOMEMADE CAKE RE ASSIETTE EUROCONTROL (Petit b...</td>
<td>2.04</td>
<td>0.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_considered_products_sale(product_names, products_sales):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    product_name_regex <span class="op">=</span> <span class="st">'|'</span>.join(product_names)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> products_sales[products_sales[<span class="st">'product_name'</span>].<span class="bu">str</span>.contains(product_name_regex)].copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>considered_products <span class="op">=</span> [<span class="st">'PLAT DU JOUR'</span>, <span class="st">'HOT BAR'</span>]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>considered_products_sales <span class="op">=</span> get_considered_products_sale(considered_products, products_sales)<span class="op">;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>total_sales_of_considered_products <span class="op">=</span> considered_products_sales[<span class="st">'total_sales'</span>].<span class="bu">sum</span>()</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>considered_products_sales[<span class="st">'sales_percentage'</span>] <span class="op">=</span> <span class="bu">round</span>(considered_products_sales[<span class="st">'total_sales'</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">/</span> total_sales_of_considered_products, <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>display(considered_products_sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">product_name</th>
<th data-quarto-table-cell-role="th">total_sales</th>
<th data-quarto-table-cell-role="th">sales_percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>HOT BAR FTK</td>
<td>26329.98</td>
<td>95.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>PLAT DU JOUR VEGE RE</td>
<td>1100.00</td>
<td>4.01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> send_mail(to <span class="op">=</span> <span class="st">'niloyrashid71@gmail.com'</span>, subject <span class="op">=</span> <span class="st">''</span>, body <span class="op">=</span> <span class="st">''</span>):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up the email message</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    msg <span class="op">=</span> MIMEMultipart()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">'From'</span>] <span class="op">=</span> <span class="st">'aragron.aragon@gmail.com'</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">'To'</span>] <span class="op">=</span> to</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Connect to the SMTP server and send the email</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    smtp_server <span class="op">=</span> <span class="st">'smtp.gmail.com'</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    smtp_port <span class="op">=</span> <span class="dv">587</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    username <span class="op">=</span> <span class="st">'aragron.aragon@gmail.com'</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    password <span class="op">=</span> <span class="st">'owdcsemibedvfhjs'</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    server <span class="op">=</span> smtplib.SMTP(smtp_server, smtp_port)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    server.starttls()</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    server.login(username, password)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add subject and body to the email message</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">'Subject'</span>] <span class="op">=</span> subject</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    msg.attach(MIMEText(body, <span class="st">'html'</span>))</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    server.sendmail(msg[<span class="st">'From'</span>], msg[<span class="st">'To'</span>], msg.as_string())</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    server.quit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>products_sales_table_html <span class="op">=</span> products_sales.to_html()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>subject <span class="op">=</span> <span class="st">'Products Sales'</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>send_mail(subject <span class="op">=</span> subject, body <span class="op">=</span> products_sales_table_html)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>considered_products_sales_table_html <span class="op">=</span> considered_products_sales.to_html()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>subject <span class="op">=</span> <span class="st">'Considered Products Sales'</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>send_mail(subject <span class="op">=</span> subject, body <span class="op">=</span> considered_products_sales_table_html)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/fonteyne/foodcosts/issues/new" class="toc-action">Report an issue</a></p></div></div></div></div></footer></body></html>